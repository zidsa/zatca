<?php
require_once("../vendor/autoload.php");;

use Zid\Zatca\Enums\ZatcaEnvironment;

$complianceService = new \Zid\Zatca\ComplianceService(ZatcaEnvironment::SANDBOX);

$ccsid = \Zid\Zatca\Entities\CSID::loadFromJson('output/ccsid.json');

$result = $complianceService->checkCompliance(
    binarySecurityToken: $ccsid->certificate,
    secret: $ccsid->secret,
    invoiceHash: '+xlRMLneuely7GRT02LBgw/GnA6h/bpwhHvVjPOwyaQ=',
    invoiceUuid: '6a7644e3-0be5-424c-9afa-cfbc42b98123',
    signedInvoice: 'PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPEludm9pY2UgeG1sbnM9InVybjpvYXNpczpuYW1lczpzcGVjaWZpY2F0aW9uOnVibDpzY2hlbWE6eHNkOkludm9pY2UtMiIgeG1sbnM6Y2FjPSJ1cm46b2FzaXM6bmFtZXM6c3BlY2lmaWNhdGlvbjp1Ymw6c2NoZW1hOnhzZDpDb21tb25BZ2dyZWdhdGVDb21wb25lbnRzLTIiIHhtbG5zOmNiYz0idXJuOm9hc2lzOm5hbWVzOnNwZWNpZmljYXRpb246dWJsOnNjaGVtYTp4c2Q6Q29tbW9uQmFzaWNDb21wb25lbnRzLTIiIHhtbG5zOmV4dD0idXJuOm9hc2lzOm5hbWVzOnNwZWNpZmljYXRpb246dWJsOnNjaGVtYTp4c2Q6Q29tbW9uRXh0ZW5zaW9uQ29tcG9uZW50cy0yIj4KCTxjYmM6UHJvZmlsZUlEPnJlcG9ydGluZzoxLjA8L2NiYzpQcm9maWxlSUQ+Cgk8Y2JjOklEPlNURFNJLTAwMDE8L2NiYzpJRD4KCTxjYmM6VVVJRD42YTc2NDRlMy0wYmU1LTQyNGMtOWFmYS1jZmJjNDJiOTgxMjM8L2NiYzpVVUlEPgoJPGNiYzpJc3N1ZURhdGU+MjAyMi0wOC0xNzwvY2JjOklzc3VlRGF0ZT4KCTxjYmM6SXNzdWVUaW1lPjE3OjQxOjA4PC9jYmM6SXNzdWVUaW1lPgoJPGNiYzpJbnZvaWNlVHlwZUNvZGUgbmFtZT0iMDEwMDAwMCI+Mzg4PC9jYmM6SW52b2ljZVR5cGVDb2RlPgoJPGNiYzpOb3RlIGxhbmd1YWdlSUQ9ImFyIj5BQkM8L2NiYzpOb3RlPgoJPGNiYzpEb2N1bWVudEN1cnJlbmN5Q29kZT5TQVI8L2NiYzpEb2N1bWVudEN1cnJlbmN5Q29kZT4KCTxjYmM6VGF4Q3VycmVuY3lDb2RlPlNBUjwvY2JjOlRheEN1cnJlbmN5Q29kZT4KCQoJPGNhYzpBZGRpdGlvbmFsRG9jdW1lbnRSZWZlcmVuY2U+CgkJPGNiYzpJRD5JQ1Y8L2NiYzpJRD4KCQk8Y2JjOlVVSUQ+MTwvY2JjOlVVSUQ+Cgk8L2NhYzpBZGRpdGlvbmFsRG9jdW1lbnRSZWZlcmVuY2U+Cgk8Y2FjOkFkZGl0aW9uYWxEb2N1bWVudFJlZmVyZW5jZT4KCQk8Y2JjOklEPlBJSDwvY2JjOklEPgoJCTxjYWM6QXR0YWNobWVudD4KCQkJPGNiYzpFbWJlZGRlZERvY3VtZW50QmluYXJ5T2JqZWN0IG1pbWVDb2RlPSJ0ZXh0L3BsYWluIj5OV1psWTJWaU5qWm1abU00Tm1Zek9HUTVOVEkzT0Raak5tUTJPVFpqTnpsak1tUmlZekl6T1dSa05HVTVNV0kwTmpjeU9XUTNNMkV5TjJaaU5UZGxPUT09PC9jYmM6RW1iZWRkZWREb2N1bWVudEJpbmFyeU9iamVjdD4KCQk8L2NhYzpBdHRhY2htZW50PgoJPC9jYWM6QWRkaXRpb25hbERvY3VtZW50UmVmZXJlbmNlPgoJPGNhYzpBY2NvdW50aW5nU3VwcGxpZXJQYXJ0eT4KCQk8Y2FjOlBhcnR5PgoJCQk8Y2FjOlBhcnR5SWRlbnRpZmljYXRpb24+CgkJCQk8Y2JjOklEIHNjaGVtZUlEPSJDUk4iPjEwMTAwMTAwMDA8L2NiYzpJRD4KCQkJPC9jYWM6UGFydHlJZGVudGlmaWNhdGlvbj4KCQkJPGNhYzpQb3N0YWxBZGRyZXNzPgoJCQkJPGNiYzpTdHJlZXROYW1lPtin2YTYp9mF2YrYsSDYs9mE2LfYp9mGIHwgUHJpbmNlIFN1bHRhbjwvY2JjOlN0cmVldE5hbWU+CgkJCQk8Y2JjOkJ1aWxkaW5nTnVtYmVyPjIzMjI8L2NiYzpCdWlsZGluZ051bWJlcj4KCQkJCTxjYmM6Q2l0eVN1YmRpdmlzaW9uTmFtZT7Yp9mE2YXYsdio2LkgfCBBbC1NdXJhYmJhPC9jYmM6Q2l0eVN1YmRpdmlzaW9uTmFtZT4KCQkJCTxjYmM6Q2l0eU5hbWU+2KfZhNix2YrYp9i2IHwgUml5YWRoPC9jYmM6Q2l0eU5hbWU+CgkJCQk8Y2JjOlBvc3RhbFpvbmU+MjMzMzM8L2NiYzpQb3N0YWxab25lPgoJCQkJPGNhYzpDb3VudHJ5PgoJCQkJCTxjYmM6SWRlbnRpZmljYXRpb25Db2RlPlNBPC9jYmM6SWRlbnRpZmljYXRpb25Db2RlPgoJCQkJPC9jYWM6Q291bnRyeT4KCQkJPC9jYWM6UG9zdGFsQWRkcmVzcz4KCQkJPGNhYzpQYXJ0eVRheFNjaGVtZT4KCQkJCTxjYmM6Q29tcGFueUlEPjM5OTk5OTk5OTkwMDAwMzwvY2JjOkNvbXBhbnlJRD4KCQkJCTxjYWM6VGF4U2NoZW1lPgoJCQkJCTxjYmM6SUQ+VkFUPC9jYmM6SUQ+CgkJCQk8L2NhYzpUYXhTY2hlbWU+CgkJCTwvY2FjOlBhcnR5VGF4U2NoZW1lPgoJCQk8Y2FjOlBhcnR5TGVnYWxFbnRpdHk+CgkJCQk8Y2JjOlJlZ2lzdHJhdGlvbk5hbWU+TFREPC9jYmM6UmVnaXN0cmF0aW9uTmFtZT4KCQkJPC9jYWM6UGFydHlMZWdhbEVudGl0eT4KCQk8L2NhYzpQYXJ0eT4KCTwvY2FjOkFjY291bnRpbmdTdXBwbGllclBhcnR5PgoJPGNhYzpBY2NvdW50aW5nQ3VzdG9tZXJQYXJ0eT4KCQk8Y2FjOlBhcnR5PgoJCQk8Y2FjOlBvc3RhbEFkZHJlc3M+CgkJCQk8Y2JjOlN0cmVldE5hbWU+2LXZhNin2K0g2KfZhNiv2YrZhiB8IFNhbGFoIEFsLURpbjwvY2JjOlN0cmVldE5hbWU+CgkJCQk8Y2JjOkJ1aWxkaW5nTnVtYmVyPjExMTE8L2NiYzpCdWlsZGluZ051bWJlcj4KCQkJCTxjYmM6Q2l0eVN1YmRpdmlzaW9uTmFtZT7Yp9mE2YXYsdmI2KwgfCBBbC1NdXJvb2o8L2NiYzpDaXR5U3ViZGl2aXNpb25OYW1lPgoJCQkJPGNiYzpDaXR5TmFtZT7Yp9mE2LHZitin2LYgfCBSaXlhZGg8L2NiYzpDaXR5TmFtZT4KCQkJCTxjYmM6UG9zdGFsWm9uZT4xMjIyMjwvY2JjOlBvc3RhbFpvbmU+CgkJCQk8Y2FjOkNvdW50cnk+CgkJCQkJPGNiYzpJZGVudGlmaWNhdGlvbkNvZGU+U0E8L2NiYzpJZGVudGlmaWNhdGlvbkNvZGU+CgkJCQk8L2NhYzpDb3VudHJ5PgoJCQk8L2NhYzpQb3N0YWxBZGRyZXNzPgoJCQk8Y2FjOlBhcnR5VGF4U2NoZW1lPgoJCQkJPGNiYzpDb21wYW55SUQ+Mzk5OTk5OTk5ODAwMDAzPC9jYmM6Q29tcGFueUlEPgoJCQkJPGNhYzpUYXhTY2hlbWU+CgkJCQkJPGNiYzpJRD5WQVQ8L2NiYzpJRD4KCQkJCTwvY2FjOlRheFNjaGVtZT4KCQkJPC9jYWM6UGFydHlUYXhTY2hlbWU+CgkJCTxjYWM6UGFydHlMZWdhbEVudGl0eT4KCQkJCTxjYmM6UmVnaXN0cmF0aW9uTmFtZT5MVEQ8L2NiYzpSZWdpc3RyYXRpb25OYW1lPgoJCQk8L2NhYzpQYXJ0eUxlZ2FsRW50aXR5PgoJCTwvY2FjOlBhcnR5PgoJPC9jYWM6QWNjb3VudGluZ0N1c3RvbWVyUGFydHk+CiAgPGNhYzpEZWxpdmVyeT4KICAgIDxjYmM6QWN0dWFsRGVsaXZlcnlEYXRlPjIwMjItMDktMDc8L2NiYzpBY3R1YWxEZWxpdmVyeURhdGU+CiAgPC9jYWM6RGVsaXZlcnk+Cgk8Y2FjOlBheW1lbnRNZWFucz4KCQk8Y2JjOlBheW1lbnRNZWFuc0NvZGU+MTA8L2NiYzpQYXltZW50TWVhbnNDb2RlPgoJPC9jYWM6UGF5bWVudE1lYW5zPgoJPGNhYzpBbGxvd2FuY2VDaGFyZ2U+CgkJPGNiYzpDaGFyZ2VJbmRpY2F0b3I+ZmFsc2U8L2NiYzpDaGFyZ2VJbmRpY2F0b3I+CgkJPGNiYzpBbGxvd2FuY2VDaGFyZ2VSZWFzb24+ZGlzY291bnQ8L2NiYzpBbGxvd2FuY2VDaGFyZ2VSZWFzb24+CgkJPGNiYzpBbW91bnQgY3VycmVuY3lJRD0iU0FSIj4wLjAwPC9jYmM6QW1vdW50PgoJCTxjYWM6VGF4Q2F0ZWdvcnk+CgkJCTxjYmM6SUQgc2NoZW1lQWdlbmN5SUQ9IjYiIHNjaGVtZUlEPSJVTi9FQ0UgNTMwNSI+UzwvY2JjOklEPgoJCQk8Y2JjOlBlcmNlbnQ+MTU8L2NiYzpQZXJjZW50PgoJCQk8Y2FjOlRheFNjaGVtZT4KCQkJCTxjYmM6SUQgc2NoZW1lQWdlbmN5SUQ9IjYiIHNjaGVtZUlEPSJVTi9FQ0UgNTE1MyI+VkFUPC9jYmM6SUQ+CgkJCTwvY2FjOlRheFNjaGVtZT4KCQk8L2NhYzpUYXhDYXRlZ29yeT4KCQk8Y2FjOlRheENhdGVnb3J5PgoJCQk8Y2JjOklEIHNjaGVtZUFnZW5jeUlEPSI2IiBzY2hlbWVJRD0iVU4vRUNFIDUzMDUiPlM8L2NiYzpJRD4KCQkJPGNiYzpQZXJjZW50PjE1PC9jYmM6UGVyY2VudD4KCQkJPGNhYzpUYXhTY2hlbWU+CgkJCQk8Y2JjOklEIHNjaGVtZUFnZW5jeUlEPSI2IiBzY2hlbWVJRD0iVU4vRUNFIDUxNTMiPlZBVDwvY2JjOklEPgoJCQk8L2NhYzpUYXhTY2hlbWU+CgkJPC9jYWM6VGF4Q2F0ZWdvcnk+Cgk8L2NhYzpBbGxvd2FuY2VDaGFyZ2U+Cgk8Y2FjOlRheFRvdGFsPgoJCTxjYmM6VGF4QW1vdW50IGN1cnJlbmN5SUQ9IlNBUiI+MzAuMTU8L2NiYzpUYXhBbW91bnQ+Cgk8L2NhYzpUYXhUb3RhbD4KCTxjYWM6VGF4VG90YWw+CgkJPGNiYzpUYXhBbW91bnQgY3VycmVuY3lJRD0iU0FSIj4zMC4xNTwvY2JjOlRheEFtb3VudD4KCQk8Y2FjOlRheFN1YnRvdGFsPgoJCQk8Y2JjOlRheGFibGVBbW91bnQgY3VycmVuY3lJRD0iU0FSIj4yMDEuMDA8L2NiYzpUYXhhYmxlQW1vdW50PgoJCQk8Y2JjOlRheEFtb3VudCBjdXJyZW5jeUlEPSJTQVIiPjMwLjE1PC9jYmM6VGF4QW1vdW50PgoJCQk8Y2FjOlRheENhdGVnb3J5PgoJCQkJPGNiYzpJRCBzY2hlbWVBZ2VuY3lJRD0iNiIgc2NoZW1lSUQ9IlVOL0VDRSA1MzA1Ij5TPC9jYmM6SUQ+CgkJCQk8Y2JjOlBlcmNlbnQ+MTUuMDA8L2NiYzpQZXJjZW50PgoJCQkJPGNhYzpUYXhTY2hlbWU+CgkJCQkJPGNiYzpJRCBzY2hlbWVBZ2VuY3lJRD0iNiIgc2NoZW1lSUQ9IlVOL0VDRSA1MTUzIj5WQVQ8L2NiYzpJRD4KCQkJCTwvY2FjOlRheFNjaGVtZT4KCQkJPC9jYWM6VGF4Q2F0ZWdvcnk+CgkJPC9jYWM6VGF4U3VidG90YWw+Cgk8L2NhYzpUYXhUb3RhbD4KCTxjYWM6TGVnYWxNb25ldGFyeVRvdGFsPgoJCTxjYmM6TGluZUV4dGVuc2lvbkFtb3VudCBjdXJyZW5jeUlEPSJTQVIiPjIwMS4wMDwvY2JjOkxpbmVFeHRlbnNpb25BbW91bnQ+CgkJPGNiYzpUYXhFeGNsdXNpdmVBbW91bnQgY3VycmVuY3lJRD0iU0FSIj4yMDEuMDA8L2NiYzpUYXhFeGNsdXNpdmVBbW91bnQ+CgkJPGNiYzpUYXhJbmNsdXNpdmVBbW91bnQgY3VycmVuY3lJRD0iU0FSIj4yMzEuMTU8L2NiYzpUYXhJbmNsdXNpdmVBbW91bnQ+CgkJPGNiYzpBbGxvd2FuY2VUb3RhbEFtb3VudCBjdXJyZW5jeUlEPSJTQVIiPjAuMDA8L2NiYzpBbGxvd2FuY2VUb3RhbEFtb3VudD4KCQk8Y2JjOlByZXBhaWRBbW91bnQgY3VycmVuY3lJRD0iU0FSIj4wLjAwPC9jYmM6UHJlcGFpZEFtb3VudD4KCQk8Y2JjOlBheWFibGVBbW91bnQgY3VycmVuY3lJRD0iU0FSIj4yMzEuMTU8L2NiYzpQYXlhYmxlQW1vdW50PgoJPC9jYWM6TGVnYWxNb25ldGFyeVRvdGFsPgoJPGNhYzpJbnZvaWNlTGluZT4KCQk8Y2JjOklEPjE8L2NiYzpJRD4KCQk8Y2JjOkludm9pY2VkUXVhbnRpdHkgdW5pdENvZGU9IlBDRSI+MzMuMDAwMDAwPC9jYmM6SW52b2ljZWRRdWFudGl0eT4KCQk8Y2JjOkxpbmVFeHRlbnNpb25BbW91bnQgY3VycmVuY3lJRD0iU0FSIj45OS4wMDwvY2JjOkxpbmVFeHRlbnNpb25BbW91bnQ+CgkJPGNhYzpUYXhUb3RhbD4KCQkJPGNiYzpUYXhBbW91bnQgY3VycmVuY3lJRD0iU0FSIj4xNC44NTwvY2JjOlRheEFtb3VudD4KCQkJPGNiYzpSb3VuZGluZ0Ftb3VudCBjdXJyZW5jeUlEPSJTQVIiPjExMy44NTwvY2JjOlJvdW5kaW5nQW1vdW50PgoJCTwvY2FjOlRheFRvdGFsPgoJCTxjYWM6SXRlbT4KCQkJPGNiYzpOYW1lPtmD2KrYp9ioPC9jYmM6TmFtZT4KCQkJPGNhYzpDbGFzc2lmaWVkVGF4Q2F0ZWdvcnk+CgkJCQk8Y2JjOklEPlM8L2NiYzpJRD4KCQkJCTxjYmM6UGVyY2VudD4xNS4wMDwvY2JjOlBlcmNlbnQ+CgkJCQk8Y2FjOlRheFNjaGVtZT4KCQkJCQk8Y2JjOklEPlZBVDwvY2JjOklEPgoJCQkJPC9jYWM6VGF4U2NoZW1lPgoJCQk8L2NhYzpDbGFzc2lmaWVkVGF4Q2F0ZWdvcnk+CgkJPC9jYWM6SXRlbT4KCQk8Y2FjOlByaWNlPgoJCQk8Y2JjOlByaWNlQW1vdW50IGN1cnJlbmN5SUQ9IlNBUiI+My4wMDwvY2JjOlByaWNlQW1vdW50PgoJCQk8Y2FjOkFsbG93YW5jZUNoYXJnZT4KCQkJCTxjYmM6Q2hhcmdlSW5kaWNhdG9yPmZhbHNlPC9jYmM6Q2hhcmdlSW5kaWNhdG9yPgoJCQkJPGNiYzpBbGxvd2FuY2VDaGFyZ2VSZWFzb24+ZGlzY291bnQ8L2NiYzpBbGxvd2FuY2VDaGFyZ2VSZWFzb24+CgkJCQk8Y2JjOkFtb3VudCBjdXJyZW5jeUlEPSJTQVIiPjAuMDA8L2NiYzpBbW91bnQ+CgkJCTwvY2FjOkFsbG93YW5jZUNoYXJnZT4KCQk8L2NhYzpQcmljZT4KCTwvY2FjOkludm9pY2VMaW5lPgoJPGNhYzpJbnZvaWNlTGluZT4KCQk8Y2JjOklEPjI8L2NiYzpJRD4KCQk8Y2JjOkludm9pY2VkUXVhbnRpdHkgdW5pdENvZGU9IlBDRSI+My4wMDAwMDA8L2NiYzpJbnZvaWNlZFF1YW50aXR5PgoJCTxjYmM6TGluZUV4dGVuc2lvbkFtb3VudCBjdXJyZW5jeUlEPSJTQVIiPjEwMi4wMDwvY2JjOkxpbmVFeHRlbnNpb25BbW91bnQ+CgkJPGNhYzpUYXhUb3RhbD4KCQkJPGNiYzpUYXhBbW91bnQgY3VycmVuY3lJRD0iU0FSIj4xNS4zMDwvY2JjOlRheEFtb3VudD4KCQkJPGNiYzpSb3VuZGluZ0Ftb3VudCBjdXJyZW5jeUlEPSJTQVIiPjExNy4zMDwvY2JjOlJvdW5kaW5nQW1vdW50PgoJCTwvY2FjOlRheFRvdGFsPgoJCTxjYWM6SXRlbT4KCQkJPGNiYzpOYW1lPtmC2YTZhTwvY2JjOk5hbWU+CgkJCTxjYWM6Q2xhc3NpZmllZFRheENhdGVnb3J5PgoJCQkJPGNiYzpJRD5TPC9jYmM6SUQ+CgkJCQk8Y2JjOlBlcmNlbnQ+MTUuMDA8L2NiYzpQZXJjZW50PgoJCQkJPGNhYzpUYXhTY2hlbWU+CgkJCQkJPGNiYzpJRD5WQVQ8L2NiYzpJRD4KCQkJCTwvY2FjOlRheFNjaGVtZT4KCQkJPC9jYWM6Q2xhc3NpZmllZFRheENhdGVnb3J5PgoJCTwvY2FjOkl0ZW0+CgkJPGNhYzpQcmljZT4KCQkJPGNiYzpQcmljZUFtb3VudCBjdXJyZW5jeUlEPSJTQVIiPjM0LjAwPC9jYmM6UHJpY2VBbW91bnQ+CgkJCTxjYWM6QWxsb3dhbmNlQ2hhcmdlPgoJCQkJPGNiYzpDaGFyZ2VJbmRpY2F0b3I+ZmFsc2U8L2NiYzpDaGFyZ2VJbmRpY2F0b3I+CgkJCQk8Y2JjOkFsbG93YW5jZUNoYXJnZVJlYXNvbj5kaXNjb3VudDwvY2JjOkFsbG93YW5jZUNoYXJnZVJlYXNvbj4KCQkJCTxjYmM6QW1vdW50IGN1cnJlbmN5SUQ9IlNBUiI+MC4wMDwvY2JjOkFtb3VudD4KCQkJPC9jYWM6QWxsb3dhbmNlQ2hhcmdlPgoJCTwvY2FjOlByaWNlPgoJPC9jYWM6SW52b2ljZUxpbmU+CjwvSW52b2ljZT4=',
);

echo 'Clearance status:' . PHP_EOL;
echo $result->clearanceStatus . PHP_EOL;
echo 'Validation status:' . PHP_EOL;
echo $result->validationResults->status . PHP_EOL;
echo 'Errors:' . PHP_EOL;
print_r($result->validationResults->errorMessages);
echo 'Warnings:' . PHP_EOL;
print_r($result->validationResults->warningMessages);
echo 'Infos:' . PHP_EOL;
print_r($result->validationResults->infoMessages);
